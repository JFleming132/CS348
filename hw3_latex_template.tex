% Only edit between \begin{questions} and \end{questions} tags.

\documentclass[12pt]{exam}
\usepackage[utf8]{inputenc}

\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amssymb}
\usepackage{multicol}
\usepackage{listings}
\usepackage{enumerate}
\usepackage{blindtext}
\usepackage{scrextend}
\usepackage{graphicx}
\usepackage{comment}

\def\ojoin{\setbox0=\hbox{$\bowtie$}%
  \rule[-.02ex]{.25em}{.4pt}\llap{\rule[\ht0]{.25em}{.4pt}}}
\def\leftouterjoin{\mathbin{\ojoin\mkern-5.8mu\bowtie}}
\def\rightouterjoin{\mathbin{\bowtie\mkern-5.8mu\ojoin}}
\def\fullouterjoin{\mathbin{\ojoin\mkern-5.8mu\bowtie\mkern-5.8mu\ojoin}}


\renewcommand{\choiceshook}{%
    \setlength{\leftmargin}{15pt}%
}
\title{CS 348 - Homework 3 }
\author{Relational Algebra}
\date{Spring 2024}

\begin{document}

\maketitle
\noindent
Write your answers for questions 1 to 9 in this latex file. Use a latex editor, such as overleaf to edit and compile your latex to a PDF file. Submit your latex file to Brightspace. Submit your PDF file to Gradescope. Question 1 includes all relational algebra operators and symbols that you can use in your answers.


\begin{questions}
\question 

\textbf{Answer:} \\
    %.........  Write your answer   ..... %	
    $ a \leftarrow \pi_{A, B}(R\bowtie S)$ \\
    $ b \leftarrow \pi_{A, B}(R\bowtie_{R.A=S.A} S)$ \\
    $\pi_{A, B}(R\times S)$ \\
    $\pi_{A, B}((\sigma_{R.A=123 \; and \; S.B <= 20000}(R\bowtie S))$ \\
    $\pi_{A, B}((\sigma_{R.A=123 \; or \; S.B<=20000}(R\bowtie S))$ \\
    $\pi_{A, B}(R\leftouterjoin S)$ \\
    $\pi_{A, B}(R\rightouterjoin S)$ \\
    $\pi_{A, B}(R\fullouterjoin S)$ \\
    $R \cap S \cup T - U $ \\
    $\sigma_{trip.id <= 7450}(trip)$ \\
\vspace{50 mm}
	
\question 

\textbf{Answer:} \\
    %.........  Write your answer   ..... %	
    
\vspace{50 mm}

\question 

\textbf{Answer:} \\
    %.........  Write your answer   ..... %	
    $\pi _{origin\_station, start\_d, duration, destination\_station} (trips \bowtie (\rho_{name\rightarrow origin\_station}(\rho_{id\rightarrow start\_station\_id}(station))) \bowtie (\rho_{name\rightarrow destination\_station}(\rho_{id\rightarrow end\_station\_id}(station))))$ \\
\vspace{50 mm}

\question 

\textbf{Answer:} \\
    %.........  Write your answer   ..... %	
    $\pi_{bike_id} ((\sigma_{station.name="Mountain View Caltrain Station"} (trip \bowtie_{trip.id=station.end\_station\_id} station)) \cap (\sigma_{station.name="Evelyn Park and Ride"} (trip \bowtie_{trip.id=station.end\_station\_id} station)))$ \\
\vspace{50 mm}

\question 

\textbf{Answer:}  \\
    %.........  Write your answer   ..... %	
    $\pi_{station.id, station.name, trip.id, trip.duration} (station \leftouterjoin_{station.id=trip.end_station_id} trip)$ \\
\vspace{50 mm}

\question 
\textbf{Answer:} \\
    %.........  Write your answer   ..... %	
    $\pi_{station.id, station.name} (station) - \pi_{station.id, station.name} (station \bowtie_{station.id=trip.start\_station\_id} trip)$ \\
\vspace{50 mm}

\question 

\textbf{Answer:} \\
    %.........  Write your answer   ..... %	
    $\pi_{s1.name, s1.id, s2.name, s2.id} (\rho_{s1} (station) \times \rho_{s2} (station)) - \pi_{s1.name, s1.id, s2.name, s2.id} ((\rho_{s1} (station) \times \rho_{s2} (station)) \bowtie_{s1.id=start\_station\_id \; and \; s2.id=end\_station\_id} trip)$\\
\vspace{50 mm}

\question 

\textbf{Answer:} \\
    %.........  Write your answer   ..... %	
    $\pi_{station\_status.station\_id, station.name, station\_status.time} (\sigma_{station\_status.docks\_available=station.dock\_count} (station\_status \bowtie_{station\_status.station\_id=station.id} station))$\\
\vspace{50 mm}

\question 
\textbf{Answer:} \\
    %.........  Write your answer   ..... %	
    $trips - \pi_{t1} (\rho_{t1} (trips) \bowtie_{t2.duration > t1.duration} \rho_{t2} (trips)))$\\
\vspace{50 mm}


\end{questions}
\bigskip 
\noindent


\end{document}
